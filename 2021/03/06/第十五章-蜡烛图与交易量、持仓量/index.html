<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="思考并回答以下问题：">
<meta name="keywords" content="日本蜡烛图技术">
<meta property="og:type" content="article">
<meta property="og:title" content="第十五章 蜡烛图与交易量、持仓量">
<meta property="og:url" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/index.html">
<meta property="og:site_name" content="车斌的技术博客">
<meta property="og:description" content="思考并回答以下问题：">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/1.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/2.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/3.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/3.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/5.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/6.jpg">
<meta property="og:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/7.jpg">
<meta property="og:updated_time" content="2021-03-06T07:51:02.266Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="第十五章 蜡烛图与交易量、持仓量">
<meta name="twitter:description" content="思考并回答以下问题：">
<meta name="twitter:image" content="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/1.jpg">






  <link rel="canonical" href="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>第十五章 蜡烛图与交易量、持仓量 | 车斌的技术博客</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">车斌的技术博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">专注</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/03/06/第十五章-蜡烛图与交易量、持仓量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CheBin">
      <meta itemprop="description" content="放弃会成为一种习惯">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="车斌的技术博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">第十五章 蜡烛图与交易量、持仓量

              
            
          </h1>
        

        <div class="post-meta">

          

          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-03-06 13:33:09 / 修改时间：15:51:02" itemprop="dateCreated datePublished" datetime="2021-03-06T13:33:09+08:00">2021-03-06</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/期货/" itemprop="url" rel="index"><span itemprop="name">期货</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">本文字数：</span>
                
                <span title="本文字数">6.7k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">6 分钟</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>思考并回答以下问题：</p>
<a id="more"></a>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a><span style="color:#339AFF;">前言</span></h1><p>“一箭易折，十箭难断”。</p>
<p>交易量的技术意义是，一段行情的交易量越重，则这段行情背后的市场力量越强大。只要交易量保持增长的态势，那么，当前的价格趋势就将持续下去。但是如果在价格趋势发展时，交易量不增反降，那么，判断当前趋势仍将继续发展的理由就不充分了。另外，我们还可以通过交易量来验证市场的顶部或底部过程。当市场向下试探某一支撑水平时，如果交易量较轻，则意味着卖出压力减弱了，因此构成了一个看涨信号。反过来，当市场向上试探先前的高点时，如果交易量较轻，则证明买进力量减弱了，构成了一个看跌信号。</p>
<p>虽然我们可以利用交易量来作为一项有力的辅助手段，衡量价格运动背后的市场强度，但是，有一些不利的因素在一定的程度上给交易量的技术意义打了折扣，特别是在期货市场上，这个问题尤为突出。首先，在期货市场上，交易量的数据是延迟一天后公布的。其次，差价套利交易有可能扭曲交易量的数字——特别是扭曲个别合约月份的交易量。另外，随着许多期货市场的期权交易日益盛行，交易量数据也可能被相应的期权套利交易所扭曲。尽管存在上述各种不利因素，交易量分析依然是一种很有价值的研究工具。在这一章中，我们来探讨将交易量与蜡烛图技术相结合的一些办法。</p>
<h1 id="交易量与蜡烛图"><a href="#交易量与蜡烛图" class="headerlink" title="交易量与蜡烛图"></a><span style="color:#339AFF;">交易量与蜡烛图</span></h1><p>如图15.1所示，将交易量与蜡烛图技术结合起来，有助于确认双重顶形态或双重底形态的形成。3月22日（即蜡烛线①），市场向上推进至2月底的高点的水平（在94美元附近）。蜡烛线①这一天的交易量为504000张合约（本章所列举的所有的交易量数据都是该品种所有合约月份的交易量的总和）。在接下来的几天中，市场曾经力图将价格推升到94美元的水平之上。但是，这些交易日的实体都比较小，反映出牛方的激情已经不足。在这些小蜡烛线处，较低的交易量也为上述看法提供了佐证。一周以后，牛方终于举手投降。3月下旬，市场在2个交易日之内下跌了两个整点。</p>
<blockquote>
<p>图15.1 美国长期国债——1990年6月，日蜡烛图（交易量与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/1.jpg">
<p>下面，我们把注意力转向4月4日的高高的白色蜡烛线（蜡烛线②）。这根坚挺的蜡烛线是否预示着牛方已经重新聚积起力量了呢？答案很可能是否定的。首先我们注意到，这个上涨交易日的交易量相对来说是较轻的，仅有300000张合约。在此之前数日，有两根长长的黑色蜡烛线（即3月29日和30日），反而具有较大的交易量。其次，在蜡烛线②之后的价格变化中，还出现了其它的不良征兆。它的下一个交易日（蜡烛线③）具有较小的实体。蜡烛线②和③共同组成了一个孕线形态。它的技术含义是，先前的上升趋势已经结束了。还请注意，这根小实体蜡烛线也是一个看跌的上吊线的变体（理想的上吊线应当出现在水平交易区间的顶部，或者出现在上升趋势的顶部）。下一天（蜡烛线④），市场最后一次对94美元的水平发起冲击，结果形成了一根兆头不祥的黄包车夫线。另一方面，在这一轮上冲行情的背后，市场的支撑力量相对是较弱的。这一点反映在当天较少的交易量（370000张合约）上，与此形成对照的是，3月22日的交易量为504000张合约。当市场以较轻的交易量向上试探过去的高点时，就增加了下述可能性：可能形成一个双重顶。当价格运动到3月30日的低点之下时，就证实了该双重顶形态的形成。根据这个双重顶形态，市场最近的价格目标位于90美元。</p>
<p>从上述讨论可见，当市场向上试探过去的高点时，如果交易量较轻，则可能标志着市场顶部的形成；如果同时还发生了蜡烛图的看跌信号，那么可能性更大。在这张图例中，我们还可以看到一个交易量/蜡烛图的复合市场底部信号的实例。4月27日，是一根十字线。根据我们在第八章的介绍，十字线在上升趋势中比在下降趋势中更有可能形成反转信号。不过，只要得到了其它技术信号的验证，它们也能够充当底部反转信号。这一点在本图所示的长期国债市场也得到了体现。在4月27日十字线的3天之后，又出现了一根十字线，这就增加了前面这根十字线的重要性。相继出现的两根十字线已经不可小视了，但是请注意，这两天还发生了其它方面的技术现象。首先，两根十字线组成了一个平头底部形态（这就是说，两根十字线的低点基本上处于同一水平）。其次，请看这两天的交易量。4月27日的交易量是448000张合约。5月2日，即第二根十字线，其交量量几乎只有前者的一半，为234000张合约。当市场以较轻的交易量向下试探某一支撑水平时，构成一个看涨信号。后来的结局再明白不过了。</p>
<p>如图15.2所示，在4月底出现的看涨的吞没形态中，白色蜡烛线的交易量在最近的几个月内都是最多的。这一点有力地证明了牛方坚定的决心。后来，有一根类似于锤子线的蜡烛线重新向下试探了这一低点，它的交易量较轻，从而证实了一个坚实的市场底部的形成。</p>
<blockquote>
<p>图15.2 欧洲美元——1990年6月，日蜡烛图（交易量与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/2.jpg">
<p>有很多种建立在交易量基础上的特殊技术分析工具。其中两个最常用的分别为权衡交易量（OBV）和即时交易量（TM）。</p>
<h1 id="权衡交易量（OBV）"><a href="#权衡交易量（OBV）" class="headerlink" title="权衡交易量（OBV）"></a><span style="color:#339AFF;">权衡交易量（OBV）</span></h1><p>权衡交易量（OBV）是一种交易量的累计净值。从一个基准日开始，当某一天的收市价高于前一天的收市价时，则将该日的交易量数值加到前一天的权衡交易量数值上；如果某一天的收市价低于前一日的收市价，则该日的交易量就从前一天累计的权衡交易量数值中减去。</p>
<p>可以按照几种不同的方式来应用权衡交易量。一个办法是，用它来验证一个趋势。OBV应当朝着当前主要趋势的方向运动。如果价格与OBV双双上涨，则说明由买方引起的交易量正在上升，即便在较高的价位上，也能达成较高的交易量。这可能构成一个看涨信号。</p>
<p>如果情况与上述方向相反，价格与OBV一齐下跌，就反映出在较低的价位上，由卖方引起的交易量也在增长，说明价格下降的过程仍将持续。</p>
<p>在横向交易区间中，也可以应用OBV。如果在价格保持稳定时（最好是在较低的价位上保持稳定），OBV开始升高，这可能揭示了一个筹码搜集的过程。这种局面预示着上涨行情的到来。如果价格持平运动，而OBV正在下跌，则反映出一个筹码派发的过程。这种局面可能具有看跌的意义，特别是当它发生在高价格水平时。</p>
<h2 id="OBV与蜡烛图"><a href="#OBV与蜡烛图" class="headerlink" title="OBV与蜡烛图"></a><span style="color:#00ACC1;">OBV与蜡烛图</span></h2><p>图15.3所示为白银市场。在6月13日沉重的抛售行情之后，跟着出现了一个小小的实体。这就形成了一个孕线形态，它将强烈的下降趋势转化为横向延伸趋势。此后数周，市场就处在该水平交易区间中。在这个期间，OBV在上升，反映了一个看涨的筹码搜集过程。6月25日，市场创出了新低，但是这一新低水平未能维持下去，结果形成了一根锤子线。OBV的正面背离现象、熊方无力维持新低水平，以及这根锤子线，三个方面归纳起来，标志着一个近期市场底部的形成。</p>
<blockquote>
<p>图15.3 白银——1990年7月，日蜡烛图（OBV与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/3.jpg">
<h1 id="即时交易量（TM）"><a href="#即时交易量（TM）" class="headerlink" title="即时交易量（TM）"></a><span style="color:#339AFF;">即时交易量（TM）</span></h1><p>在期货市场上，交易量要迟一天才能发布。为了规避这个障碍，许多技术分析者采取即时交易量TM作为一种替代品，以在日内时间单位的基础上找着几分交易量的“感觉”。即时交易量TM体现的是每个日内时间段内的成交笔数之和。它并不反映每笔交易成交的合约张数。举例来说，即时交易量可能显示在某一小时内共成交50笔买卖。在这50笔交易中，我们无从知道每笔到底有多少张合约。它们既可能是50笔单手的小额交易，也可能是50笔50~100手的大额交易。从这个意义上说，即时交易量不是真正的交易量。话说回来，即时交易量还是实用的，因为这是我们现场估量交易量的唯一手段，虽然较不精确，但更为及时。</p>
<h2 id="即时交易量（TM）与蜡烛图"><a href="#即时交易量（TM）与蜡烛图" class="headerlink" title="即时交易量（TM）与蜡烛图"></a><span style="color:#00ACC1;">即时交易量（TM）与蜡烛图</span></h2><p>图15.4所示为一张日内的小时蜡烛线图，从中可以体会到即时交易量TM的用处。当5月4日形成了一根看涨的锤子线之后，价格开始上扬。但是，这一轮上涨行情却伴随着下降的即时交易量TM。这是一个迹象，表明牛方的信心不足。还有其它的迹象，那便是这些小小的白色实体。在5月8日的头3个小时里，发生了急剧的价格下滑，为当前的趋势创出了新低。5月8日后来的日内价格变化提供了一些线索，显示早晨的抛售行情可能持续不下去。在第三个小时的长长的黑色蜡烛线之后，出现了一根十字线。这两根蜡烛线组成了一个十字孕线形态。几个小时之后，出现了一根白色实体，它向上覆盖了之前的两根黑色实体。这就形成了一个看涨的吞没形态，并且由于它向上吞没了两个黑色实体，从而具备了额外的份量。另外，这根白色的吞没线的低点与之前的一个低点还构成了一个平头底部形态。</p>
<blockquote>
<p>图15.4 可可——1990年7月，日蜡烛图（即时交易量与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/3.jpg">
<p>要是您认为上述各方面线索还不足以构成一个底部反转信号的话，那么此处的即时交易量提供了进一步的证据，证实买方已经占据了上风。在上述的看涨吞没形态之后，价格开始上涨。在这一轮上涨行情中，交易量逐步扩张，并且各个蜡烛线实体的高度也呈逐步放大的态势。后来，当市场达到前一周形成的阻挡水平1340美元附近时，形成了一根流星线，这根流星线，加上上述阻挡水平，使当前的价格上涨暂时平息了下来。一旦市场以窗口的形式向上突破了1340美元的阻挡水平，则所有的疑虑一扫而光：牛方牢牢地把握着主动权。</p>
<p>如图15.5所示，6月19日的一个锤子线是一个标志，说明市场可能正在探寻底部。在 6月20日的头一个小时，市场达到了16.62美元的新低水平（蜡烛线①）。这一小时的即时交易量TM仅有区区的324笔交易。同一天晚些时候，市场再度向下尝试这一水平，并形成了一根长长的黑色蜡烛线（蜡烛线②）。这一次，即时交易量TM仅有262笔交易。下一天，即6月21日，最有意思。在这个交易日的第三个小时，价格向下开创了当前趋势的新低水平，16.57美元。创造这个新低时的即时交易量TM（249笔交易）比前两次向下试探时（蜡烛线①和蜡烛线②）来得更轻。这就意味着抛售压力正在减弱。于是，价格向上反弹，并形成了一根锤子线。（根据第十一章对破低反涨形态的有关介绍，我们现在预期市场将向上试探前一个高点，即17.24美元附近的水平。）</p>
<blockquote>
<p>图15.5 原油——1990年8月，日蜡烛图（即时交易量TM与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/5.jpg">
<h1 id="持仓量"><a href="#持仓量" class="headerlink" title="持仓量"></a><span style="color:#339AFF;">持仓量</span></h1><p>在期货市场上，当一位新的买入者与一位新的卖出者达成买卖协议时，就产生了一张新合约。因为这一原因，期货市场里流通的合约总额，可能超过相应的实物商品的实际供给量。持仓量是所有的敞口多头头寸或所有的敞口空头头寸单边的总和，而不是它们双边的总和。</p>
<p>持仓量的作用与交易量有些类似，也有助于衡量价格运动背后的市场力度。根据持仓量的增减，我们就可以判断资金是流入某一市场，还是流出某一市场，因此，它就具备了上述用途。持仓量的上升或下降，取决于两方面因素的消长对比：新入市的买入者或卖出者的数额，与新出市的原有交易者的数额。</p>
<p>价格趋势的发展应当伴随着逐步增长的持仓量，这一部分的焦点就是要交代清楚这一点的重要性。我们必须牢记以下重要原则，如果在价格趋势的演进过程中，持仓量呈上升态势，则有助于验证当前的价格趋势。举例来说，如果市场正在上涨，而持仓量也在增长，就说明新的多头比新的空头更为主动积极。上升的持仓量显示，既有新的买进者入市，也有新的卖出者入市，但是其中新的多头更为积极，大胆，因为尽管价格不断上扬，这群新的多头者依然继续买进。</p>
<p>另一种情形是，价格下跌，而持仓量逐步积累，这就反映出熊方的信念很坚定。这是因为，上升的持仓量表明，既有新的多头者入市，也有新的空头者入市，但是尽管是在不断下降的价格水平上，这群新的空头者仍然愿意卖出。综合上述，如果在上升趋势中持仓量是上升的，则一般说来，牛方占据主动，上涨行情仍将持续；如果在下降趋势中持仓量是上升的，则说明熊方占据主动，下跌行情仍将持续。</p>
<p>与上述情况相反，如果在市场趋势的发展过程中，持仓量下降，则构成了一个表示趋势或许难以为继的信号。为什么呢？因为持仓量的下降说明，原来持有头寸的市场参与者必定正在平仓出市，放弃这个市场。在理论上，一旦这些旧的头寸平仓完毕，则当前市场运动的驱动力量就将烟消云散。从这个意义上说，如果在市场上扬时，持仓量下降，那么这段上涨行情是由于空头买入平仓行为所引起的（以及原来的多头者趁机对冲头寸）。等到原有的这群空头者逃离了该市场，那么上述上涨行情（即空头买进平仓行情）背后的驱动力也随之瓦解，这就意味着当前的市场较为脆弱，容易诱发进一步的疲弱行情。</p>
<p>我们不妨打个比方，假定有一根水管接在自来水干线上。在自来水干线与这条水管之间安装了一个水龙头。上升的持仓量相当于打开了水龙头，从自来水干线向水管里输入自来水。那么，只要水龙头是开着的，就会不断地从水管里面流出水来（这就相当于上升的持仓量将价格进一步推高或推低）。下降的持仓量好像是关上了水龙头。开始，还有水从水管子里面流出来（因为水管子里面还有一些剩水），但是一旦剩水全部滴出来了，就不再有新的来源维持水流了。结果，水流（相当于价格趋势）就会枯竭。</p>
<p>关于持仓量，还应当考虑其它因素（比如季节性因素等），不过我们此处又打算对持仓量作一点简要的说明，不可能面面俱到。</p>
<h2 id="持仓量与蜡烛图"><a href="#持仓量与蜡烛图" class="headerlink" title="持仓量与蜡烛图"></a><span style="color:#00ACC1;">持仓量与蜡烛图</span></h2><p>图15.1所示为长期国债市场，其中显示出丰富的交易量信息。本图还展示了上升的持仓量在验证价格趋势方面的重要性。现在我们回头再来看看这张图表，不过，这一回请把注意力放在持仓量图线上。对图15.1，我们可以进行以下几个方面的分析。</p>
<p>从3月13日开始，长期国债市场形成了一轮较小的上冲行情，一直持续到3月22日。在这轮上涨行情的演化过程中，持仓量是下降的。这就意味着这一轮上涨行情是由于空头者买进平仓引起的。一旦空头者买进平仓的过程结束，这轮上涨行情也就结束了。这段上涨行情终止于蜡烛线①。这一天形成了一根黄包车夫线，并且标志着市场对2月底位于94美元附近的高点的试探的失败。4月9日，当图示的抛售行情开始的时候，持仓量也随之上升。上升的持仓量意味着新的多头者和新的空头者入市买卖。不过，熊方显然更为积极大胆，因为他们在逐步下降的价格水平上依然愿意卖出。在整个4月份的下跌过程中持仓量持续增长。4月27日和5月2日，市场形成了两根十字线（在88.5的水平上）。从这时起，持仓量开始水平伸展。这反映出能方卖出压力的衰减。</p>
<p>如图15.6所示，在整个5月里，价格上涨，持仓量也上涨，形成了一种健康的组合。但是在6月份，虽然价格继续上涨，持仓量却在下降，这种反差就显得不太正常了。这就说明，6月份的上涨行情在很大程度上是由于空头买进平仓所引起的。就上涨行情的进一步发展来说，这样的局面不是一个好的征兆。图示的流星线标志着市场顶部的形成，在接下来的4个交易日里，市场一下子便抹消了过去花费了约一个月积累起来的价格上涨。</p>
<blockquote>
<p>图15.6 棉花——1990年12月，日蜡烛图（持仓量与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/6.jpg">
<p>当市场处于新高水平时，如果持仓量恰巧也达到了异乎寻常的高水平，可能预示着市场即将陷入困境。这是因为，上升的持仓量意味着新的空头者和新的多头者正在进入市场。如果市场处于稳步上涨的上升趋势中，那么，这些新的多头者将会随着价格水平的逐步上升，逐步提高卖出止损指令的水平。万一价格突然下滑，将引发执行止损指令的连锁反应，有可能导致价格的狂泻。图15.7所示的实例很好地体现了上述道理。该图选自原糖市场。从3月初开始，在2个月之内，市场始终在从0.15美元到0.16美元的区间中波动。在4月下旬发生的最后一段上涨行情中，持仓量发生了显著的增长。到5月初，持仓量已经达到了很不寻常的高水平。随着这个上涨行情的发展，新的多头者的卖出止损水平也就水涨船高，逐步抬升到较高的价位。这时出现了一系列十字线，它们暗示市场已经转入犹豫不决的状态，可能形成一个顶部。5月4日，市场受到打压，于是，一个止损指令接着一个止损指令被触发，如同多米诺骨牌，结果，市场直线下跌。</p>
<blockquote>
<p>图15.7 原糖——1990年7月，日蜡烛图（持仓量与蜡烛图）</p>
</blockquote>
<img src="/2021/03/06/第十五章-蜡烛图与交易量、持仓量/7.jpg">
<p>这种高水平的持仓量还有另一方面的特点。有一部分新的多头没有能够止损出市，被套牢在较高的价格水平上。这是因为随着持仓量的累积，新的多头和新的空头不断涌入市场。但是，由于这场急转直下的下跌行情，价格已经回落到了2个月内的最低水平。凡是在过去两个月中买进者，现在都处于亏损状态。那些在接近价格高点处买进的多头者更是备受“煎熬”。从接近0.16美元的高水平处的高额持仓量来判断，很可能有不少多头处在这种“备受煎熬”状况中。那么，他们将利用一切可能的上涨行情来平仓出市。这种情景展现在5月中旬。当时市场曾经形成了一段较小的上涨行值，达到了0.15美元，于是马上招致了沉重的抛售压力。</p>

      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/日本蜡烛图技术/" rel="tag"># 日本蜡烛图技术</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2021/03/06/第十四章-蜡烛图与摆动指数/" rel="next" title="第十四章 蜡烛图与摆动指数">
                <i class="fa fa-chevron-left"></i> 第十四章 蜡烛图与摆动指数
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2021/03/06/第十六章-蜡烛图与艾略特波浪理论/" rel="prev" title="第十六章 蜡烛图与艾略特波浪理论">
                第十六章 蜡烛图与艾略特波浪理论 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="CheBin">
            
              <p class="site-author-name" itemprop="name">CheBin</p>
              <div class="site-description motion-element" itemprop="description">放弃会成为一种习惯</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">207</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">27</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          

          

          
          


          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <!-- modify icon to fire by szw -->
                <i class="fa fa-history fa-" aria-hidden="true"></i>
                近期文章
              </div>
              <ul class="links-of-blogroll-list">
                
                
                  <li>
                    <a href="/2021/03/14/第四章-日内各时段交易思路与策略/" title="第四章 日内各时段交易思路与策略" target="_blank">第四章 日内各时段交易思路与策略</a>
                  </li>
                
                  <li>
                    <a href="/2021/03/14/第八章-日内短线出场技巧/" title="第八章 日内短线出场技巧" target="_blank">第八章 日内短线出场技巧</a>
                  </li>
                
                  <li>
                    <a href="/2021/03/13/第七章-日内短线交易高胜算空单进场方法/" title="第七章 日内短线交易高胜算空单进场方法" target="_blank">第七章 日内短线交易高胜算空单进场方法</a>
                  </li>
                
                  <li>
                    <a href="/2021/03/13/第六章-日内短线交易高胜算多单进场方法/" title="第六章 日内短线交易高胜算多单进场方法" target="_blank">第六章 日内短线交易高胜算多单进场方法</a>
                  </li>
                
                  <li>
                    <a href="/2021/03/09/第一章-期货交易的几大类型/" title="第一章 期货交易的几大类型" target="_blank">第一章 期货交易的几大类型</a>
                  </li>
                
              </ul>
            </div>
        

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#交易量与蜡烛图"><span class="nav-number">2.</span> <span class="nav-text">交易量与蜡烛图</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#权衡交易量（OBV）"><span class="nav-number">3.</span> <span class="nav-text">权衡交易量（OBV）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#OBV与蜡烛图"><span class="nav-number">3.1.</span> <span class="nav-text">OBV与蜡烛图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#即时交易量（TM）"><span class="nav-number">4.</span> <span class="nav-text">即时交易量（TM）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#即时交易量（TM）与蜡烛图"><span class="nav-number">4.1.</span> <span class="nav-text">即时交易量（TM）与蜡烛图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#持仓量"><span class="nav-number">5.</span> <span class="nav-text">持仓量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#持仓量与蜡烛图"><span class="nav-number">5.1.</span> <span class="nav-text">持仓量与蜡烛图</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CheBin</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">站点总字数：</span>
    
    <span title="站点总字数">2.2m</span>
  

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    
    <span title="站点阅读时长">32:48</span>
  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a></div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>



  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  
  

  


  

  

  

  

  

  

  

  

  
<script>
  $('.highlight').each(function(i, e) {
    var $wrap = $('<div>').addClass('highlight-wrap');
    $(e).after($wrap);
    $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function(e) {
      var code = $(this).parent().find('.code').find('.line').map(function(i, e) {
        return $(e).text();
      }).toArray().join('\n');
      var ta = document.createElement('textarea');
      var yPosition = window.pageYOffset || document.documentElement.scrollTop;
      ta.style.top = yPosition + 'px'; // Prevent page scroll
      ta.style.position = 'absolute';
      ta.style.opacity = '0';
      ta.readOnly = true;
      ta.value = code;
      document.body.appendChild(ta);
      ta.select();
      ta.setSelectionRange(0, code.length);
      ta.readOnly = false;
      var result = document.execCommand('copy');
      
        if (result) $(this).text('复制成功');
        else $(this).text('复制失败');
      
      ta.blur(); // For iOS
      $(this).blur();
    })).on('mouseleave', function(e) {
      var $b = $(this).find('.copy-btn');
      setTimeout(function() {
        $b.text('复制');
      }, 300);
    }).append(e);
  })
</script>


  

  

</body>
</html>
